<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv='X-UA-Compatible' content='IE=edge'>
        <title>SAPUI5 demo</title>
        <script id="sap-ui-bootstrap"
           src="/sap/public/bc/ui5_ui5/1/resources/sap-ui-core.js"
           data-sap-ui-theme="sap_platinum"
           data-sap-ui-libs="sap.ui.commons, sap.ui.table"></script>
    </head>
    <body id="sapUiBody">
        <div id="headerTable"></div>
        <div style="margin-top:20px" id="itemsTable"></div>
    </body>
    <script type="text/javascript">
    	var oModelHeader = new sap.ui.model.json.JSONModel();   	
    	oModelHeader.loadData("/sap/bc/resources/workorders");
    	
    	//Create an instance of the table control
    	var oTableHeader = new sap.ui.table.Table({
    		title : "Work orders",
    		visibleRowCount : 10,
    		firstVisibleRow : 1,
    		selectionMode : sap.ui.table.SelectionMode.Single
    	});

    	oTableHeader.addColumn(new sap.ui.table.Column({
    		label : new sap.ui.commons.Label({
    			text : "Work order"
    		}),
    		template : new sap.ui.commons.TextView().bindProperty("text",
    				"aufnr"),
    		width : "100px"
    	}));

    	oTableHeader.addColumn(new sap.ui.table.Column({
    		label : new sap.ui.commons.Label({
    			text : "Order type"
    		}),
    		template : new sap.ui.commons.TextView().bindProperty("text",
    				"auart")
    	}));

    	oTableHeader.addColumn(new sap.ui.table.Column({
    		label : new sap.ui.commons.Label({
    			text : "Description"
    		}),
    		template : new sap.ui.commons.TextView().bindProperty("text",
    				"ktext")
    	}));

    	oTableHeader.addColumn(new sap.ui.table.Column({
    		label : new sap.ui.commons.Label({
    			text : "Plant"
    		}),
    		template : new sap.ui.commons.TextView().bindProperty("text",
    				"werks")
    	}));

    	oTableHeader.setModel(oModelHeader);
    	oTableHeader.bindRows("/itab");

        // Handle work order selection
        var oModelItems = new sap.ui.model.json.JSONModel();       
        oTableHeader.attachRowSelectionChange(function (event) {
           var selectedRowContext = event.getParameter("rowContext");
           oModelItems.loadData("/sap/bc/resources/workorders/" + selectedRowContext.getObject().aufnr);
           oTableItems.setModel(oModelItems);
           oTableItems.bindRows("/itab"); 
        });

        oTableHeader.placeAt("headerTable");



        //Items table 
        var oTableItems = new sap.ui.table.Table({
            title : "Operations",
            visibleRowCount : 5,
            firstVisibleRow : 1,
            showNoData: false, 
            selectionMode : sap.ui.table.SelectionMode.Single
        });

        oTableItems.addColumn(new sap.ui.table.Column({
            label : new sap.ui.commons.Label({
                text : "Item no."
            }),
            template : new sap.ui.commons.TextView().bindProperty("text",
                    "vornr"),
            width:"100px"
        }));

        oTableItems.addColumn(new sap.ui.table.Column({
            label : new sap.ui.commons.Label({
                text : "Plant"
            }),
            template : new sap.ui.commons.TextView().bindProperty("text",
                    "werks"),
            width:"100px"
        }));

        oTableItems.addColumn(new sap.ui.table.Column({
            label : new sap.ui.commons.Label({
                text : "Control key"
            }),
            template : new sap.ui.commons.TextView().bindProperty("text",
                    "steus"),
            width:"100px"
        }));

        oTableItems.addColumn(new sap.ui.table.Column({
            label : new sap.ui.commons.Label({
                text : "Short text"
            }),
            template : new sap.ui.commons.TextView().bindProperty("text",
                    "ltxa1")
        }));

        oTableItems.placeAt("itemsTable");

    </script>
</html>
